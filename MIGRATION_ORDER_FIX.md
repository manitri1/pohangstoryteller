# 🔧 마이그레이션 순서 오류 해결

## 🚨 현재 문제

- **오류**: `P0001: 필수 관광지 데이터가 없습니다. 이전 마이그레이션 파일들을 먼저 실행하세요.`
- **원인**: 마이그레이션 파일들이 올바른 순서로 실행되지 않음
- **결과**: `20241219_003_pohang_tourist_spots.sql`에서 필수 데이터를 찾을 수 없음

## 📋 올바른 마이그레이션 순서

### 1단계: 데이터베이스 초기화 (필요시)

```sql
-- 20241219_000_drop_all_tables.sql 실행
-- 모든 테이블과 데이터 삭제
```

### 2단계: 스키마 생성

```sql
-- 20241219_001_initial_schema.sql 실행
-- 기본 테이블 구조 생성
```

### 3단계: 샘플 데이터 삽입

```sql
-- 20241219_002_sample_data.sql 실행
-- 기본 관광지 및 코스 데이터 삽입
```

### 4단계: 추가 관광지 데이터

```sql
-- 20241219_003_pohang_tourist_spots.sql 실행
-- 추가 관광지 데이터 삽입 (중복 방지)
```

### 5단계: 개발용 사용자 생성

```sql
-- 20241219_004_dev_users.sql 실행
-- 테스트용 사용자 계정 생성
```

### 6단계: 사용자 참여 데이터

```sql
-- 20241219_005_user_engagement_data.sql 실행
-- 사용자 활동 및 참여 데이터 삽입
```

### 7단계: 스키마 확장 (선택사항)

```sql
-- 20241219_006_add_routes_description.sql 실행
-- routes 테이블에 description 컬럼 추가
```

## 🛠️ 해결 방법

### 방법 1: 순차적 마이그레이션 (권장)

1. Supabase 대시보드에서 SQL Editor 열기
2. 위 순서대로 각 마이그레이션 파일 내용을 복사하여 실행
3. 각 단계마다 오류 확인

### 방법 2: 통합 마이그레이션 파일 생성

모든 마이그레이션을 하나의 파일로 통합하여 순서 보장

## ⚠️ 주의사항

- **순서 중요**: 각 마이그레이션은 이전 마이그레이션에 의존
- **중복 방지**: `ON CONFLICT DO NOTHING` 사용
- **데이터 검증**: 각 단계 후 데이터 확인
